
#include "Mapper079.h"
#include <cassert>

SETUP_STATIC_INES_MAPPER_REGISTRAR(79);

//------------------------------------------------------------------------------
// Name:
//------------------------------------------------------------------------------
Mapper79::Mapper79() {
	set_prg_89abcdef(0);
	set_chr_0000_1fff(0);
}

//------------------------------------------------------------------------------
// Name:
//------------------------------------------------------------------------------
std::string Mapper79::name() const {
	return "NINA-003/NINA-006";
}

//------------------------------------------------------------------------------
// Name:
//------------------------------------------------------------------------------
void Mapper79::write_4(uint16_t address, uint8_t value) {
	if((address & 0x4100) == 0x4100) {
		write_handler(address, value);
	} else {
		Mapper::write_4(address, value);
	}
}

//------------------------------------------------------------------------------
// Name:
//------------------------------------------------------------------------------
void Mapper79::write_5(uint16_t address, uint8_t value) {
	if((address & 0x4100) == 0x4100) {
		write_handler(address, value);
	} else {
		Mapper::write_5(address, value);
	}
}

//------------------------------------------------------------------------------
// Name:
//------------------------------------------------------------------------------
void Mapper79::write_handler(uint16_t address, uint8_t value) {
	assert((address & 0x4100) == 0x4100);

	(void)address;

	set_prg_89abcdef((value >> 3) & 0x07);
	set_chr_0000_1fff((value & 0x07) | ((value & 0x40) >> 3));
}
